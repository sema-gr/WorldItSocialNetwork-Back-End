model Album {
  id         Int      @id @default(autoincrement())
  name       String
  // theme String?
  // year String?
  images     Image[]
  created_at DateTime @default(now())
  shown      Boolean  @default(false)
  topic      String?
  author     Profile  @relation(fields: [authorId], references: [id])
  authorId   Int
}

model ChatGroup {
  id             Int           @id @default(autoincrement())
  name           String
  isPersonalChat Boolean       @default(false)
  members        Profile[]     @relation("groupMembers")
  admin          Profile       @relation("administeredGroup", fields: [adminId], references: [id])
  adminId        Int
  avatar         String
  chatMessages   ChatMessage[]
}

model ChatMessage {
  id            Int       @id @default(autoincrement())
  content       String
  sentAt        DateTime  @default(now())
  author        Profile   @relation(fields: [authorId], references: [id])
  authorId      Int
  chatGroup     ChatGroup @relation(fields: [chatGroupId], references: [id])
  chatGroupId   Int
  attachedImage String
}

model Friendship {
  id       Int     @id @default(autoincrement())
  profile1 Profile @relation("friendshipFrom", fields: [idFromId], references: [id])
  profile2 Profile @relation("friendshipTo", fields: [idTo], references: [id])
  idTo     Int
  idFromId Int
  accepted Boolean @default(false)
}

model Image {
  id         Int      @id @default(autoincrement())
  url        String
  uploadedAt DateTime @default(now())

  // post UserPost? @relation(fields: [userPostId], references: [id])
  // userPostId Int?

  // album Album? @relation(fields: [albumId], references: [id])
  // albumId Int?

  UserPost UserPost[]
  Album    Album[]
}

model UserPost {
  id       Int       @id @default(autoincrement())
  title    String
  // theme String?
  tags     Tags[]
  content  String
  images   Image[]
  views    Profile[] @relation("views")
  likes    Profile[] @relation("likes")
  author   Profile   @relation(fields: [authorId], references: [id])
  authorId Int
  link     Link?     @relation(fields: [linkId], references: [id])
  linkId   Int?
}

model Tags {
  id       Int        @id @default(autoincrement())
  name     String
  // userPosts UserPostTags[]
  UserPost UserPost[]
}

model Link {
  id       Int        @id @default(autoincrement())
  url      String
  userPost UserPost[] @relation()
}

// model UserPostTags {
//     userPostId Int
//     tagId Int
//     userPost UserPost @relation(fields: [userPostId], references: [id])
//     tag Tags @relation(fields: [tagId], references: [id])
//     @@id([userPostId, tagId])
// }
model Profile {
  id                 Int           @id @default(autoincrement())
  name               String?
  username           String?       @unique
  surname            String?
  dateOfBirth        DateTime?
  email              String        @unique
  password           String
  image              String?
  about              String?
  signature          String?
  post               UserPost[]
  album              Album[]
  chats              ChatGroup[]   @relation("groupMembers")
  administeredGroups ChatGroup[]   @relation("administeredGroup")
  chatMessages       ChatMessage[]
  userPostViews      UserPost[]    @relation("views")
  userPostLikes      UserPost[]    @relation("likes")
  avatar             Avatar?
  friendshipFrom     Friendship[]  @relation("friendshipFrom")
  friendshipTo       Friendship[]  @relation("friendshipTo")
}

model Avatar {
  id        Int     @id @default(autoincrement())
  image     String
  profile   Profile @relation(fields: [profileId], references: [id])
  profileId Int     @unique
  shown     Boolean @default(true)
  active    Boolean @default(true)
}

// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}
